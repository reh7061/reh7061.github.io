---
layout: post
title: "Malware Analysis: Sample A"
date: 2024-11-12
categories: malware-analysis
---

# Malware Analysis: Sample A

## Overview
This malware sample is a trojan designed to steal sensitive information from infected machines. It was initially distributed via a phishing email campaign.

## Tools Used
- **Ghidra**: For static analysis of the malware's disassembly.
- **Wireshark**: For analyzing network traffic.

## Behavior Analysis
### Step 1: Static Analysis
1. **Unpacking**: The malware was packed with UPX. Used UPX to unpack the binary.
2. **Disassembly**: Loaded the unpacked binary in **Ghidra** to locate suspicious function calls.

### Step 2: Dynamic Analysis
1. **Network Traffic**: Used **Wireshark** to capture the traffic and observed connections to `malicious-domain.com`.
2. **File Drops**: The malware created several files in the `%APPDATA%` directory.

```python
# Decrypting C2 server URL using a basic XOR method
def decrypt_url(encrypted_url):
    key = 0xAA
    decrypted = ''.join(chr(ord(c) ^ key) for c in encrypted_url)
    return decrypted
