---
title: "Malware Unpacking Guide – Part 1: Static Analysis & PE Header Recon"
excerpt: "First steps decoding a packed Windows PE sample: identifying packers, extracting sections, and prepping the sample for dynamic execution."
date: 2025-06-12
categories:
  - unpacking
tags: [malware, static-analysis, pe]
series: "Malware Unpacking Guide"
toc: true
layout: single
---

> *“The best debugger is a sharp pair of eyes.”*  
> —Someone who definitely stared at **too many** hex editors.

## 1. Identify the packer

```bash
$ die.exe packed_sample.exe
[PE32] UPX v3.95 (Win32) -> Markus Oberhumer, Laszlo Molnar & John Reiser
```

## 2. Verify section anomalies

```
; Interesting section table excerpt
.text       00003000 00001000 60000020
.upx0       00000000 00000000 E0000020 ; 🤔 no raw data yet executable?
.upx1       00009000 00002000 E0000020
```

## 3. Prepare for dynamic run

Create a VM snapshot and set a hardware breakpoint on `VirtualAlloc`:

```asm
push ebp
mov  ebp, esp
call dword ptr [<&kernel32.VirtualAlloc>]
```

:::note
Once execution lands **after** this call, you usually find the original Entry Point (OEP) in memory.
:::

---
Next: [Part 2 →](/unpacking/malware-unpacking-part-2/)  
